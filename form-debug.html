<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Debug Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8 bg-gray-100">
  <div class="max-w-md mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-6">Form Debug Test</h1>
    
    <!-- Simple Contact Form -->
    <form data-webglo-form="contact" class="space-y-4">
      <div>
        <label class="block text-sm font-medium mb-2">First Name</label>
        <input type="text" name="firstName" required class="w-full p-2 border rounded">
      </div>
      <div>
        <label class="block text-sm font-medium mb-2">Last Name</label>
        <input type="text" name="lastName" required class="w-full p-2 border rounded">
      </div>
      <div>
        <label class="block text-sm font-medium mb-2">Email</label>
        <input type="email" name="email" required class="w-full p-2 border rounded">
      </div>
      <div>
        <label class="block text-sm font-medium mb-2">Message</label>
        <textarea name="message" required class="w-full p-2 border rounded"></textarea>
      </div>
      <!-- Honeypot -->
      <input type="text" name="website" style="display: none;" tabindex="-1">
      <button type="submit" class="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600">
        Send Test Message
      </button>
    </form>

    <!-- Simple Newsletter Form -->
    <form data-webglo-form="newsletter" class="space-y-4 mt-8 pt-8 border-t">
      <h3 class="font-bold">Newsletter Test</h3>
      <div>
        <label class="block text-sm font-medium mb-2">Email</label>
        <input type="email" name="email" required class="w-full p-2 border rounded">
      </div>
      <!-- Honeypot -->
      <input type="text" name="website" style="display: none;" tabindex="-1">
      <button type="submit" class="w-full bg-green-500 text-white p-2 rounded hover:bg-green-600">
        Subscribe Test
      </button>
    </form>

    <!-- Debug Info -->
    <div class="mt-8 p-4 bg-gray-100 rounded">
      <h3 class="font-bold mb-2">Debug Info:</h3>
      <div id="debug-info" class="text-sm space-y-1">
        <div>Loading debug info...</div>
      </div>
    </div>
  </div>

  <!-- Load the separated form handlers -->
  <script src="js/security-config.js"></script>
  <script src="js/contact-form-handler.js"></script>
  <script src="js/newsletter-handler.js"></script>
  <script src="js/form-manager.js"></script>
  
  <script>
    // Debug script for separated form handlers
    function updateDebugInfo() {
      const debugDiv = document.getElementById('debug-info');
      const info = [];
      
      // Check if separated form handlers exist
      info.push(`ContactFormHandler class: ${typeof ContactFormHandler !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      info.push(`NewsletterHandler class: ${typeof NewsletterHandler !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      info.push(`FormManager class: ${typeof FormManager !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      
      // Check if instances exist
      info.push(`webgloContactHandler: ${typeof window.webgloContactHandler !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      info.push(`webgloNewsletterHandler: ${typeof window.webgloNewsletterHandler !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      info.push(`webgloFormManager: ${typeof window.webgloFormManager !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      
      // Check SecurityConfig
      info.push(`SecurityConfig: ${typeof SecurityConfig !== 'undefined' ? 'âœ… Available' : 'âŒ Missing'}`);
      
      // Check forms
      const contactForms = document.querySelectorAll('form[data-webglo-form="contact"]');
      const newsletterForms = document.querySelectorAll('form[data-webglo-form="newsletter"]');
      const allForms = document.querySelectorAll('form[data-webglo-form]');
      
      info.push(`Contact forms found: ${contactForms.length}`);
      info.push(`Newsletter forms found: ${newsletterForms.length}`);
      info.push(`Total forms found: ${allForms.length}`);
      
      // Check form manager status
      if (window.webgloFormManager) {
        const status = window.webgloFormManager.getStatus();
        info.push(`Handlers loaded: ${status.handlersLoaded}`);
      }
      
      // Check URLs
      if (window.webgloContactHandler) {
        info.push(`Contact Script URL: ${window.webgloContactHandler.scriptUrl}`);
      }
      if (window.webgloNewsletterHandler) {
        info.push(`Newsletter Script URL: ${window.webgloNewsletterHandler.scriptUrl}`);
      }
      
      // Check for any JavaScript errors
      info.push(`Console: Check browser console for error messages`);
      
      debugDiv.innerHTML = info.map(item => `<div class="p-1 border-b text-sm">${item}</div>`).join('');
    }

    // Update debug info periodically
    setInterval(updateDebugInfo, 1000);
    
    // Also update on load
    window.addEventListener('load', updateDebugInfo);
    
    // Add extra logging
    console.log('ğŸ”§ Debug page loaded - Separated Form Handlers');
    console.log('Available globals:', {
      ContactFormHandler: typeof ContactFormHandler,
      NewsletterHandler: typeof NewsletterHandler,
      FormManager: typeof FormManager,
      SecurityConfig: typeof SecurityConfig,
      webgloContactHandler: typeof window.webgloContactHandler,
      webgloNewsletterHandler: typeof window.webgloNewsletterHandler,
      webgloFormManager: typeof window.webgloFormManager
    });

    // Add test functions for easy debugging
    window.testContactForm = () => {
      if (window.webgloContactHandler) {
        console.log('ğŸ“ Testing contact form handler...');
        console.log('Contact handler status:', window.webgloContactHandler);
      } else {
        console.error('âŒ Contact handler not available');
      }
    };

    window.testNewsletterForm = () => {
      if (window.webgloNewsletterHandler) {
        console.log('ï¿½ Testing newsletter handler...');
        console.log('Newsletter handler status:', window.webgloNewsletterHandler);
      } else {
        console.error('âŒ Newsletter handler not available');
      }
    };

    window.testFormManager = () => {
      if (window.webgloFormManager) {
        console.log('ğŸ“‹ Form manager status:', window.webgloFormManager.getStatus());
      } else {
        console.error('âŒ Form manager not available');
      }
    };
  </script>
</body>
</html>
